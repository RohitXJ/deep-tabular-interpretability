{% extends "base.html" %}

{% block content %}
    

    <div id="results-content" style="display: block;">
        <h3>Step 4: Analysis Results</h3>
        <p id="feature-info"></p>
        <hr>
        <h4>Model Evaluation Report</h4>
        <pre id="report-content"></pre>
        <hr>
        <a href="{{ url_for('main.upload') }}">Start New Analysis</a>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const featureInfo = document.getElementById('feature-info');
            const reportContent = document.getElementById('report-content');

            fetch("{{ url_for('main.run_analysis') }}")
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        reportContent.textContent = 'An error occurred: ' + data.error;
                    } else {
                        featureInfo.innerHTML = data.num_features_message;
                        reportContent.textContent = data.final_report;
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    reportContent.textContent = 'An error occurred while fetching the results.';
                });
        });
    </script>
{% endblock %}
